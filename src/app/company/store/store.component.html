<div class="row">
  <div class="col-12 col-xl-8 pr-xl-0 mb-3 mb-xl-0">
    <section class="company-rates">
      <div class="d-flex flex-row align-items-center">
        <h1 class="mb-0 mr-2">Avaliações</h1>
        <span *ngIf="rates?.length > 0">({{total}} avaliações)</span>
      </div>
      <div class="d-flex flex-row align-items-center flex-wrap mt-2 mb-3" >
        <span style="font-weight: 500; color: #333;" class="mr-2">Filtrar</span>
        <div class="filter m-2" [ngClass]="{ 'active': typeFilter }">
          <button class="filter-button" (click)="toggleType('type')" [ngClass]="{'selected': typeArray.length > 0 }">
            <span *ngIf="selectedTypes.length <= 0">Tipo</span>
            <ul class="list-comma" *ngIf="selectedTypes.length > 0">
              <li color="primary"  *ngFor="let type of selectedTypes">
                {{type.name}}
              </li>
            </ul>
          </button>
          <div class="filter-wrapper">
            <div class="filter-box p-2">
              <div class="d-flex flex-column">
                <mat-checkbox color="primary"  *ngFor="let type of types" [checked]="checkSelectedType(type.type)" (change)="toggleValueType(type.type)">{{type.name}}</mat-checkbox>
              </div>
            </div>
          </div>
          <div class="filter-overlay" (click)="closeType('type')"></div>
        </div>
        <div class="filter m-2" [ngClass]="{ 'active': starFilter }">
          <div class="d-flex flex-row align-items-center">
            <button class="filter-button" (click)="toggleType('star')" [ngClass]="{'selected': filter.value.star }">
              <span *ngIf="!filter.value.star">Estrelas</span>
              <div class="d-flex flex-row align-items-center" *ngIf="filter.value.star">
                <span   [innerHTML]="sRate.startsHTML(filter.value.star)"></span>
              </div>
            </button>
            <button *ngIf="filter.value.star" color="primary" style="outline: 0;" class="ml-2" mat-icon-button (click)="clearStar()" >
              <mat-icon class="mat-18" style="font-size: 18px;">close</mat-icon>
          </button>
          </div>
          <div class="filter-wrapper">
            <div class="filter-box p-2">
              <div class="d-flex flex-column">
                <mat-radio-group [formControl]="filter.controls.star">
                  <mat-radio-button [value]="star" *ngFor="let star of stars" color="primary">
                    <span [innerHTML]="sRate.startsHTML(star)"></span>
                  </mat-radio-button>
                </mat-radio-group>
              </div>
            </div>
          </div>
          <div class="filter-overlay" (click)="closeType('star')"></div>
        </div>
        <div class="filter m-2" [ngClass]="{ 'active': votedFilter }">
          <button class="filter-button" (click)="toggleType('order')" [ngClass]="{'selected': orderName().type != 0 }">
            <div class="d-flex flex-row align-items-center">
              <span class="d-block mr-1" style="font-weight: 600; color: #333;">Ordenar por:</span> {{ orderName().name }}
            </div>
          </button>
          <div class="filter-wrapper">
            <div class="filter-box p-2">
              <div class="d-flex flex-column">
                <mat-radio-group [formControl]="filter.controls.order">
                  <mat-radio-button [value]="order.type" *ngFor="let order of orders" color="primary">{{ order.name }}</mat-radio-button>
                </mat-radio-group>
              </div>
            </div>
          </div>
          <div class="filter-overlay" (click)="closeType('voted')"></div>
        </div>
      </div>
      <div *ngIf="isRateLoading">
        <ngx-content-loading
        [speed]="'1500ms'"
        [width]="900"
        [height]="100">
            <svg:g ngx-rect width="150" height="8" y="10" x="0" rx="5" ry="5"></svg:g>
            <svg:g ngx-rect width="90" height="8" y="40" x="0" rx="5" ry="5"></svg:g>
            <svg:g ngx-rect width="250" height="12" y="70" x="0" rx="5" ry="5"></svg:g>
            <svg:g ngx-rect width="120" height="12" y="100" x="0" rx="5" ry="5"></svg:g>
      </ngx-content-loading>
      <ngx-content-loading
      [speed]="'1500ms'"
      [width]="900"
      [height]="100">
          <svg:g ngx-rect width="150" height="8" y="10" x="0" rx="5" ry="5"></svg:g>
          <svg:g ngx-rect width="90" height="8" y="40" x="0" rx="5" ry="5"></svg:g>
          <svg:g ngx-rect width="315" height="12" y="70" x="0" rx="5" ry="5"></svg:g>
          <svg:g ngx-rect width="120" height="12" y="100" x="0" rx="5" ry="5"></svg:g>
      </ngx-content-loading>
      </div>
      <ul class="list-rates" *ngIf="rates?.length > 0">
        <li class="rate-item" *ngFor="let rate of rates; let i = index">
          <div class="d-flex align-items-center justify-content-between">
            <div class="d-flex flex-column">
             <div class="d-flex flex-row align-items-center justify-content-between">
              <span class="user-name mb-0">{{ rate?.name ? rate?.name : 'Anônimo' }} </span>
              <span class="badge ml-3" [ngClass]="{'badge-primary': rate.type === 'praise', 'badge-secondary': rate.type === 'suggestion', 'badge-warning': rate.type === 'claim'}">
                <span *ngIf="rate.type === 'suggestion'">Sugestão</span>
                <span *ngIf="rate.type === 'claim'">Reclamação</span>
                <span *ngIf="rate.type === 'praise'">Avaliação</span>
              </span>
             </div>
              <div class="d-flex flex-row align-items-center" [innerHTML]="rateService.startsHTML(rate?.rate)"></div>
            </div>
            <span class="rate-time">{{ rate?.createdAt | date: 'dd/MM/yyyy' }}</span>
          </div>
          <div class="rate-body">
            <p class="comment my-3">{{ rate?.description }}</p>
              <fieldset class="rate-actions" [disabled]="checkHasVoted(rate._id)">

                <button class="rate up" matRipple (click)="like(rate._id, i)" [ngClass]="{ 'active': checkVotes(rate._id, 'likes') }">
                  <mat-icon>thumb_up_alt</mat-icon>
                  <span class="ml-2">{{ rate?.like }}</span>
                </button>
                <button class="rate bottom" matRipple (click)="deslike(rate._id, i)" [ngClass]="{ 'active': checkVotes(rate._id, 'deslikes') }">
                  <mat-icon>thumb_down_alt</mat-icon>
                  <span class="ml-2">{{ rate?.deslike }}</span>
                </button>
              </fieldset>
          </div>
        </li>
      </ul>
      <button mat-stroked-button (click)="getMoreRates()" *ngIf="rates?.length != total" class="w-100" style="height: 45px">
        <div class="d-flex flex-row align-items-center justify-content-center">
          <mat-spinner diameter="27" class="mr-2" *ngIf="loadingRates"></mat-spinner>
          <span *ngIf="loadingRates">
            Carregando...
          </span>
          <span *ngIf="!loadingRates" class="d-flex align-items-center flex-row">
            <mat-icon class="mr-2">expand_more</mat-icon>
            Carregar mais
          </span>

        </div>
      </button>
      <div class="d-flex flex-colum align-items-center justify-content-center" style="min-height: 10vh;" *ngIf="rates?.length <= 0">
        <h2>Nenhuma avaliação no momento</h2>
      </div>
    </section>
  </div>
  <div class="col-12 col-xl-4">
    <div class="about-company">
      <div class="about-title">
        <h1>Sobre</h1>
      </div>
      <div class="about-body" *ngIf="company?.category.length > 0">
        <h3 style="font-size: 16px; font-weight: 500; ">Categorias</h3>
        <mat-chip-list>
        <mat-chip *ngFor="let category of company.category" [routerLink]="['/stores/c/'+category._id]" style="cursor: pointer;">
          {{category.type}}
        </mat-chip>
      </mat-chip-list>
      </div>
      <div class="about-body" *ngIf="company?.facebook || company?.linkedin || company?.instagram">
        <h3 style="font-size: 16px; font-weight: 500; ">Social</h3>
        <ul class="list-social">
          <li>
            <a [href]="company?.facebook" target="_blank" matRipple class="d-flex flex-row align-items-center">
              <mat-icon class="mr-2">facebook</mat-icon> Facebook
            </a>
          </li>
          <li>
            <a [href]="company?.instagram" target="_blank" matRipple class="d-flex flex-row align-items-center">
              <svg id="Layer" class="mr-2" enable-background="new 0 0 64 64" height="24px" viewBox="0 0 64 64" width="24px"
                xmlns="http://www.w3.org/2000/svg">
                <path
                  d="m42 8h-20c-7.72 0-14 6.28-14 14v20c0 7.72 6.28 14 14 14h20c7.72 0 14-6.28 14-14v-20c0-7.72-6.28-14-14-14zm10 34c0 5.514-4.486 10-10 10h-20c-5.514 0-10-4.486-10-10v-20c0-5.514 4.486-10 10-10h20c5.514 0 10 4.486 10 10z" />
                <path
                  d="m32 21c-6.065 0-11 4.935-11 11s4.935 11 11 11 11-4.935 11-11-4.935-11-11-11zm0 18c-3.86 0-7-3.14-7-7s3.14-7 7-7 7 3.14 7 7-3.14 7-7 7z" />
                <path d="m45 16c-1.654 0-3 1.346-3 3s1.346 3 3 3 3-1.346 3-3-1.346-3-3-3z" /></svg>
              Instagram
            </a>
          </li>
          <li>
            <a [href]="company?.linkedin" target="_blank" matRipple class="d-flex flex-row align-items-center">
              <svg version="1.1" class="mr-2" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                width="24px" height="24px" viewBox="0 0 510 510" style="enable-background:new 0 0 510 510;" xml:space="preserve">
              <g>
                <g id="post-linkedin">
                  <path d="M459,0H51C22.95,0,0,22.95,0,51v408c0,28.05,22.95,51,51,51h408c28.05,0,51-22.95,51-51V51C510,22.95,487.05,0,459,0z
                    M153,433.5H76.5V204H153V433.5z M114.75,160.65c-25.5,0-45.9-20.4-45.9-45.9s20.4-45.9,45.9-45.9s45.9,20.4,45.9,45.9
                    S140.25,160.65,114.75,160.65z M433.5,433.5H357V298.35c0-20.399-17.85-38.25-38.25-38.25s-38.25,17.851-38.25,38.25V433.5H204
                    V204h76.5v30.6c12.75-20.4,40.8-35.7,63.75-35.7c48.45,0,89.25,40.8,89.25,89.25V433.5z"/>
                </g>
              </g>
              </svg>
              Linkedin
            </a>
          </li>
        </ul>
      </div>
      <div class="about-body" *ngIf="company?.place">
        <h3 style="font-size: 16px; font-weight: 500; ">Endereço</h3>
        <p class="mb-1">{{ company?.place.address }}, {{ company?.place.district }} - {{ company?.place.cep  | mask:'00000-000' }} </p>
        <p><b>{{ company?.place.city }}</b> - {{ company?.place.uf }} </p>
      </div>
    </div>
  </div>
</div>
<div class="d-flex flex-colum align-items-center justify-content-center" style="min-height: 20vh;" *ngIf="company?.length <= 0">
  <h2>Não encontramos nenhuma empresa.</h2>
</div>
